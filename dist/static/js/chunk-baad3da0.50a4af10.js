(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-baad3da0"],{"740c":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"error"},[t._v(t._s(t.errorMessage))]),t.title?s("div",[t._v("Курс: "),s("b",[t._v(t._s(t.title.course.label))]),t._v(" / Группа: "),s("b",[t._v(t._s(t.title.group.label))]),t._v(" / Предмет: "),s("b",[t._v(t._s(t.title.subject.label))])]):t._e(),s("b-table",{attrs:{items:t.students,fields:t.studFields,striped:""},scopedSlots:t._u([{key:"cell(show_details)",fn:function(e){return[s("b-button",{staticClass:"mr-2",attrs:{size:"sm"},on:{click:e.toggleDetails}},[t._v(" "+t._s(e.detailsShowing?"Скрыть":"Показать")+" ")]),s("b-button",{attrs:{size:"sm",variant:"success"},on:{click:function(s){return t.showAddSkip(e.item)}}},[t._v(" Добавить Пропуск ")])]}},{key:"row-details",fn:function(e){return[s("b-table",{attrs:{items:e.item.dates,fields:t.datesFields,dark:!0},scopedSlots:t._u([{key:"cell(actions)",fn:function(o){return[s("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(s){return t.handleRemoveAbsenteeism(o.item,e.item.id)}}},[t._v(" X ")])]}}],null,!0)})]}}])}),s("b-button",{on:{click:function(e){return t.$bvModal.show("get-students-modal")}}},[t._v("Получить список студентов")]),s("b-modal",{attrs:{id:"get-students-modal",title:"Получить посещаемость студентов"},on:{ok:t.getStudents}},[s("b-form",[s("b-form-group",{attrs:{label:"Курс:"}},[s("b-form-select",{attrs:{options:t.local_courses},model:{value:t.localId.course,callback:function(e){t.$set(t.localId,"course",e)},expression:"localId.course"}})],1),null!=t.localId.course?s("b-form-group",{attrs:{label:"Группа:"}},[s("b-form-select",{attrs:{options:t.local_courses[t.localId.course].groups},model:{value:t.localId.group,callback:function(e){t.$set(t.localId,"group",e)},expression:"localId.group"}})],1):t._e(),null!=t.localId.group?s("b-form-group",{attrs:{label:"Предмет:"}},[s("b-form-select",{attrs:{options:t.local_courses[t.localId.course].groups[t.localId.group].subjects},model:{value:t.localId.subject,callback:function(e){t.$set(t.localId,"subject",e)},expression:"localId.subject"}})],1):t._e()],1)],1),s("b-modal",{attrs:{id:"add-skip",title:t.addSkipTitle},on:{ok:t.handleAddSkip}},[s("b-form-datepicker",{model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1)},l=[],a=(s("d81d"),s("b0c0"),s("5530")),c=s("2f62"),u=s("c1df"),r=s.n(u),n={name:"AcademicPerformance",data:function(){return{localId:{course:null,group:null,subject:"tset"},studFields:[{key:"name",label:"Имя"},{key:"amount",label:"Пропуски"},{key:"show_details",label:"Действия"}],datesFields:[{key:"view",label:"Даты пропусков"},{key:"actions",label:"Действия"}],currentStudent:null,date:""}},computed:Object(a["a"])({},Object(c["c"])({courses:function(t){return t.courses},title:function(t){return t.title},students:function(t){return t.students.map((function(t){return Object(a["a"])({},t,{amount:t.dates.length,_showDetails:!1,dates:t.dates.map((function(t){return Object(a["a"])({},t,{view:r()(t).format("DD-MM-YYYY")})}))})}))},errorMessage:function(t){return t.errorMessage}}),{local_courses:function(){return this.courses.map((function(t,e){return Object(a["a"])({},t,{value:e,text:t.order,groups:t.groups?t.groups.map((function(t,e){return Object(a["a"])({},t,{value:e,text:t.name,subjects:t.subjects?t.subjects.map((function(t,e){return Object(a["a"])({},t,{value:e,text:t.name})})):[]})})):[]})}))},addSkipTitle:function(){return this.currentStudent?"Добавить пропуск ".concat(this.currentStudent.name):""}}),methods:{checkGetStudentsFormValid:function(){for(var t in this.localId)if(null==this.localId[t])return!1;return!0},getStudents:function(t){var e=this;t.preventDefault(),this.checkGetStudentsFormValid()&&(this.$store.dispatch("getStudents",{course:{id:this.local_courses[this.localId.course].id,label:this.local_courses[this.localId.course].order},group:{id:this.local_courses[this.localId.course].groups[this.localId.group].id,label:this.local_courses[this.localId.course].groups[this.localId.group].name},subject:{id:this.local_courses[this.localId.course].groups[this.localId.group].subjects[this.localId.subject].id,label:this.local_courses[this.localId.course].groups[this.localId.group].subjects[this.localId.subject].name}}),setTimeout((function(){e.$bvModal.hide("get-students-modal")}),10))},showAddSkip:function(t){this.currentStudent=t,this.$bvModal.show("add-skip")},handleAddSkip:function(t){var e=this;t.preventDefault(),this.date&&(this.$store.dispatch("addAbsenteeism",{date:r()(this.date).format("DD-MM-YYYY"),studentId:this.currentStudent.id,subject:this.local_courses[this.localId.course].groups[this.localId.group].subjects[this.localId.subject].id}),this.currentStudent=null,this.date=null,setTimeout((function(){e.$bvModal.hide("add-skip")}),10))},handleRemoveAbsenteeism:function(t,e){this.$store.dispatch("removeAbsenteeism",{date:t.view,studentId:e,subject:this.local_courses[this.localId.course].groups[this.localId.group].subjects[this.localId.subject].id})}},mounted:function(){this.$bvModal.show("get-students-modal"),this.$store.dispatch("getCourses")}},i=n,d=(s("aaf9"),s("2877")),b=Object(d["a"])(i,o,l,!1,null,"66d8bb7a",null);e["default"]=b.exports},aaf9:function(t,e,s){"use strict";var o=s("e2e6"),l=s.n(o);l.a},d81d:function(t,e,s){"use strict";var o=s("23e7"),l=s("b727").map,a=s("1dde"),c=s("ae40"),u=a("map"),r=c("map");o({target:"Array",proto:!0,forced:!u||!r},{map:function(t){return l(this,t,arguments.length>1?arguments[1]:void 0)}})},e2e6:function(t,e,s){}}]);
//# sourceMappingURL=chunk-baad3da0.50a4af10.js.map